<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Surrogate Model Asisted Synchronized Hyperband Optimizer — OptimizerSmashy • smashy</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Surrogate Model Asisted Synchronized Hyperband Optimizer — OptimizerSmashy"><meta property="og:description" content="Perform Surrogate Model Assisted Hyperband Optimization.
Given a population size mu, a fraction of surviving individuals survival_fraction, a number of generations n and a fidelity progression F1, F1, ..., Fn,
the algorithm works as follows:
Sample an initial design of size mu at fidelity F1
Kill individuals that are not in the top survival_fraction part of individuals, by performance
Generate new individuals using random sampling and optionally a Filtor, until mu alive individuals are present again.
Evaluate all alive individuals at fidelity F{generation}
Jump to 2., until termination, possibly because n generations are reached.


The number of generations n is determined from the OptimInstance's Terminator object, see Terminating
below.
The fidelity progression uses a specially designated &quot;budget&quot; parameter of the OptimInstance, which must have a &quot;budget&quot; tag.
The lower limit of the budget parameter is used as F0. The upper limit is used as Fn. The budget is evaluated at equally spaced values in generations 0..n,
so F1 - F0 = F2 - F1 etc. In many cases it is desirable to have a multiplicative progression of &quot;difficulty&quot; of the problem. In this case, it is
recommended to use a budget parameter with exponential &quot;trafo&quot;, or one with logscale = TRUE (see example).
A Filtor can be used for filtering, see the respective class's documentation for details on algorithms. The FiltorSurrogateProgressive can be used
for progressive surrogate model filtering. FiltorMaybe can be used for random interleaving."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">smashy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0-9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">
    <span class="fa fa-file-alt"></span>
     
    Reference
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mlr-org/smashy/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/" class="external-link">
    <span class="fa fa-comments"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Surrogate Model Asisted Synchronized Hyperband Optimizer</h1>
    <small class="dont-index">Source: <a href="https://github.com/mlr-org/smashy/blob/HEAD/R/OptimizerSmashy.R" class="external-link"><code>R/OptimizerSmashy.R</code></a>, <a href="https://github.com/mlr-org/smashy/blob/HEAD/R/TunerSmashy.R" class="external-link"><code>R/TunerSmashy.R</code></a></small>
    <div class="hidden name"><code>OptimizerSmashy.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform Surrogate Model Assisted Hyperband Optimization.</p>
<p>Given a population size <code>mu</code>, a fraction of surviving individuals <code>survival_fraction</code>, a number of generations <code>n</code> and a fidelity progression <code>F1</code>, <code>F1</code>, ..., <code>Fn</code>,
the algorithm works as follows:</p><ol><li><p>Sample an initial design of size <code>mu</code> at fidelity <code>F1</code></p></li>
<li><p>Kill individuals that are not in the top <code>survival_fraction</code> part of individuals, by performance</p></li>
<li><p>Generate new individuals using random sampling and optionally a <code><a href="Filtor.html">Filtor</a></code>, until <code>mu</code> alive individuals are present again.</p></li>
<li><p>Evaluate all alive individuals at fidelity <code>F{generation}</code></p></li>
<li><p>Jump to 2., until termination, possibly because <code>n</code> generations are reached.</p></li>
</ol><p>The number of generations <code>n</code> is determined from the <code><a href="https://bbotk.mlr-org.com/reference/OptimInstance.html" class="external-link">OptimInstance</a></code>'s <code><a href="https://bbotk.mlr-org.com/reference/Terminator.html" class="external-link">Terminator</a></code> object, see <strong>Terminating</strong>
below.</p>
<p>The <strong>fidelity progression</strong> uses a specially designated "budget" parameter of the <code><a href="https://bbotk.mlr-org.com/reference/OptimInstance.html" class="external-link">OptimInstance</a></code>, which must have a <code>"budget"</code> tag.
The lower limit of the budget parameter is used as <code>F0</code>. The upper limit is used as <code>Fn</code>. The budget is evaluated at equally spaced values in generations <code>0..n</code>,
so <code>F1</code> - <code>F0</code> = <code>F2</code> - <code>F1</code> etc. In many cases it is desirable to have a multiplicative progression of "difficulty" of the problem. In this case, it is
recommended to use a budget parameter with exponential "trafo", or one with <code>logscale = TRUE</code> (see example).</p>
<p>A <code><a href="Filtor.html">Filtor</a></code> can be used for filtering, see the respective class's documentation for details on algorithms. The <code><a href="dict_filtors_surprog.html">FiltorSurrogateProgressive</a></code> can be used
for progressive surrogate model filtering. <code><a href="dict_filtor_maybe.html">FiltorMaybe</a></code> can be used for random interleaving.</p>
    </div>


    <div id="fidelity-steps">
    <h2>Fidelity Steps</h2>
    

<p>The number of fidelity steps can be determined through the <code>fidelity_steps</code> configuration parameter, or can be determined when a
<code><a href="mlr_terminators_gens.html">TerminatorGenerations</a></code> is used to determine the number of fidelity refinements that are being performed. For this, the  <code><a href="https://bbotk.mlr-org.com/reference/OptimInstance.html" class="external-link">OptimInstance</a></code>
being optimized must contain a <code><a href="mlr_terminators_gens.html">TerminatorGenerations</a></code>, either directly (<code>inst$terminator</code>), or indirectly through a
<code><a href="https://bbotk.mlr-org.com/reference/mlr_terminators_combo.html" class="external-link">bbotk::TerminatorCombo</a></code> with <code>$any</code> set to <code>TRUE</code> (recursive <code><a href="https://bbotk.mlr-org.com/reference/mlr_terminators_combo.html" class="external-link">TerminatorCombo</a></code> may also be used).</p>
    </div>
    <div id="configuration-parameters">
    <h2>Configuration Parameters</h2>
    

<p><code>OptimizerSmashy</code>'s configuration parameters are the hyperparameters of the <code><a href="Filtor.html">Filtor</a></code> given to the <code>filtor</code> construction argument, as well as:</p><ul><li><p><code>mu</code> :: <code>integer(1)</code><br>
Population size: Number of individuals that are sampled in the beginning, and which are re-evaluated in each fidelity step. Initialized to 2.</p></li>
<li><p><code>survival_fraction</code> :: <code>numeric(1)</code><br>
Fraction of the population that survives at each fidelity step. The number of newly sampled individuals is (1 - <code>survival_fraction</code>) * <code>mu</code>. Initialized to 0.5.</p></li>
<li><p><code>sampling</code> :: <code>function</code><br>
Function that generates the initial population, as well as new individuals to be filtered from, as a <code><a href="https://paradox.mlr-org.com/reference/Design.html" class="external-link">Design</a></code> object. The function must have
arguments <code>param_set</code> and <code>n</code> and function like <code><a href="https://paradox.mlr-org.com/reference/generate_design_random.html" class="external-link">paradox::generate_design_random</a></code> or <code><a href="https://paradox.mlr-org.com/reference/generate_design_lhs.html" class="external-link">paradox::generate_design_lhs</a></code>.
This is equivalent to the <code>initializer</code> parameter of <code><a href="mies_init_population.html">mies_init_population()</a></code>, see there for more information. Initialized to
<code><a href="https://paradox.mlr-org.com/reference/generate_design_random.html" class="external-link">generate_design_random()</a></code>.</p></li>
<li><p><code>fidelity_steps</code> :: <code>integer(1)</code><br>
Number of fidelity steps, must be at least 1.</p></li>
<li><p><code>synchronize_batches</code> :: <code>logical(1)</code><br>
Whether to use synchronized batches, as opposed to "Hyperband"-like successive halfing. Initialized to <code>TRUE</code>.</p></li>
<li><p><code>filter_with_max_budget</code> :: <code>logical(1)</code><br>
Whether to perform filtering with the maximum fidelity value found in the archive, as opposed the current <code>budget_survivors</code>. This has only an effect when
<code>fidelity_steps</code> is greater than 1 and some evaluations are done when the archive already contains evaluations with greater fidelity. Initialized to <code>FALSE</code>.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other optimizers: 
<code><a href="OptimizerMies.html">OptimizerMies</a></code></p></div>
    </div>
    <div id="super-class">
    <h2>Super class</h2>
    <p><code><a href="https://bbotk.mlr-org.com/reference/Optimizer.html" class="external-link">bbotk::Optimizer</a></code> -&gt; <code>OptimizerSmashy</code></p>
    </div>
    <div id="active-bindings">
    <h2>Active bindings</h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>filtor</code></dt>
<dd><p>(<code><a href="Filtor.html">Filtor</a></code>)<br>
Filtering algorithm used.</p></dd>


<dt><code>selector</code></dt>
<dd><p>(<code><a href="Selector.html">Selector</a></code>)<br>
Survival selector used between fidelity steps.</p></dd>


<dt><code>param_set</code></dt>
<dd><p>(<code><a href="https://paradox.mlr-org.com/reference/ParamSet.html" class="external-link">ParamSet</a></code>)<br>
Configuration parameters of the optimization algorithm.</p></dd>


</dl><p></p></div>
    </div>
    <div id="methods">
    <h2>Methods</h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-OptimizerSmashy-new"><code>OptimizerSmashy$new()</code></a></p></li>
<li><p><a href="#method-OptimizerSmashy-clone"><code>OptimizerSmashy$clone()</code></a></p></li>
</ul></div><p><details open><summary>Inherited methods</summary><ul><li><span class="pkg-link" data-pkg="bbotk" data-topic="Optimizer" data-id="format"><a href="https://bbotk.mlr-org.com/reference/Optimizer.html#method-format"><code>bbotk::Optimizer$format()</code></a></span></li>
<li><span class="pkg-link" data-pkg="bbotk" data-topic="Optimizer" data-id="help"><a href="https://bbotk.mlr-org.com/reference/Optimizer.html#method-help"><code>bbotk::Optimizer$help()</code></a></span></li>
<li><span class="pkg-link" data-pkg="bbotk" data-topic="Optimizer" data-id="optimize"><a href="https://bbotk.mlr-org.com/reference/Optimizer.html#method-optimize"><code>bbotk::Optimizer$optimize()</code></a></span></li>
<li><span class="pkg-link" data-pkg="bbotk" data-topic="Optimizer" data-id="print"><a href="https://bbotk.mlr-org.com/reference/Optimizer.html#method-print"><code>bbotk::Optimizer$print()</code></a></span></li>
</ul></details></p><hr><a id="method-OptimizerSmashy-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Initialize the 'OptimizerSmashy' object.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/OptimizerSmashy.html">OptimizerSmashy</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>filtor <span class="op">=</span> <span class="va"><a href="../reference/dict_filtors_proxy.html">FiltorProxy</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>, selector <span class="op">=</span> <span class="va"><a href="../reference/dict_selectors_proxy.html">SelectorProxy</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>filtor</code></dt>
<dd><p>(<code><a href="Filtor.html">Filtor</a></code>)<br><code><a href="Filtor.html">Filtor</a></code> for the filtering algorithm. Default is <code><a href="dict_filtors_proxy.html">FiltorProxy</a></code>, which exposes the operation as
a configuration parameter of the optimizer itself.<br>
The <code>$filtor</code> field will reflect this value.</p></dd>


<dt><code>selector</code></dt>
<dd><p>(<code><a href="Selector.html">Selector</a></code>)<br><code><a href="Selector.html">Selector</a></code> that chooses which individuals survive to the next higher fidelity step.
Note this is potentially different from the selection done in <code>filtor</code> (although the common case
would be to use the same <code><a href="Selector.html">Selector</a></code> in both).
The <code>$selector</code> field will reflect this value.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-OptimizerSmashy-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">OptimizerSmashy</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>
    <div id="super-classes">
    <h2>Super classes</h2>
    <p><code><a href="https://mlr3tuning.mlr-org.com/reference/Tuner.html" class="external-link">mlr3tuning::Tuner</a></code> -&gt; <code><a href="https://mlr3tuning.mlr-org.com/reference/TunerFromOptimizer.html" class="external-link">mlr3tuning::TunerFromOptimizer</a></code> -&gt; <code>TunerSmashy</code></p>
    </div>
    <div id="methods">
    <h2>Methods</h2>
    
<div class="section">
<h3 id="public-methods-1">Public methods<a class="anchor" aria-label="anchor" href="#public-methods-1"></a></h3>

<ul><li><p><a href="#method-TunerSmashy-new"><code>TunerSmashy$new()</code></a></p></li>
<li><p><a href="#method-TunerSmashy-clone"><code>TunerSmashy$clone()</code></a></p></li>
</ul></div><p><details open><summary>Inherited methods</summary><ul><li><span class="pkg-link" data-pkg="mlr3tuning" data-topic="Tuner" data-id="format"><a href="https://mlr3tuning.mlr-org.com/reference/Tuner.html#method-format"><code>mlr3tuning::Tuner$format()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3tuning" data-topic="Tuner" data-id="help"><a href="https://mlr3tuning.mlr-org.com/reference/Tuner.html#method-help"><code>mlr3tuning::Tuner$help()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3tuning" data-topic="Tuner" data-id="print"><a href="https://mlr3tuning.mlr-org.com/reference/Tuner.html#method-print"><code>mlr3tuning::Tuner$print()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3tuning" data-topic="TunerFromOptimizer" data-id="optimize"><a href="https://mlr3tuning.mlr-org.com/reference/TunerFromOptimizer.html#method-optimize"><code>mlr3tuning::TunerFromOptimizer$optimize()</code></a></span></li>
</ul></details></p><hr><a id="method-TunerSmashy-new"></a><div class="section">
<h3 id="method-new--1">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new--1"></a></h3>
<p>Initialize the <code>TunerSmashy</code> object.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/OptimizerSmashy.html">TunerSmashy</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>filtor <span class="op">=</span> <span class="va"><a href="../reference/dict_filtors_proxy.html">FiltorProxy</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>, selector <span class="op">=</span> <span class="va"><a href="../reference/dict_selectors_proxy.html">SelectorProxy</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>surrogate_learner</code></dt>
<dd><p>(<code><a href="https://mlr3.mlr-org.com/reference/LearnerRegr.html" class="external-link">mlr3::LearnerRegr</a></code> | <code>NULL</code>)</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-TunerSmashy-clone"></a><div class="section">
<h3 id="method-clone--1">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone--1"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">TunerSmashy</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu">lgr</span><span class="fu">::</span><span class="fu"><a href="https://s-fleck.github.io/lgr/reference/simple_logging.html" class="external-link">threshold</a></span><span class="op">(</span><span class="st">"warn"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span><span class="co"># Optimizing a Function</span></span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://bbotk.mlr-org.com" class="external-link">"bbotk"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define the objective to optimize</span></span></span>
<span class="r-in"><span><span class="co"># The 'budget' here simulates averaging 'b' samples from a noisy function</span></span></span>
<span class="r-in"><span><span class="va">objective</span> <span class="op">&lt;-</span> <span class="va"><a href="https://bbotk.mlr-org.com/reference/ObjectiveRFun.html" class="external-link">ObjectiveRFun</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">xs</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="va">xs</span><span class="op">$</span><span class="va">y</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">2</span> <span class="op">-</span> <span class="va">xs</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="op">(</span><span class="fl">2</span> <span class="op">-</span> <span class="va">xs</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">z</span> <span class="op">&lt;-</span> <span class="va">z</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">xs</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Obj <span class="op">=</span> <span class="va">z</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span>,</span></span>
<span class="r-in"><span>  domain <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html" class="external-link">ps</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html" class="external-link">p_dbl</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html" class="external-link">p_dbl</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html" class="external-link">p_int</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  codomain <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html" class="external-link">ps</a></span><span class="op">(</span>Obj <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html" class="external-link">p_dbl</a></span><span class="op">(</span>tags <span class="op">=</span> <span class="st">"maximize"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">search_space</span> <span class="op">=</span> <span class="va">objective</span><span class="op">$</span><span class="va">domain</span><span class="op">$</span><span class="fu">search_space</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/to_tune.html" class="external-link">to_tune</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/to_tune.html" class="external-link">to_tune</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  b <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/to_tune.html" class="external-link">to_tune</a></span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html" class="external-link">p_int</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">^</span><span class="fl">10</span>, logscale <span class="op">=</span> <span class="cn">TRUE</span>, tags <span class="op">=</span> <span class="st">"budget"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get a new OptimInstance. Here we determine that the optimizatoin goes</span></span></span>
<span class="r-in"><span><span class="co"># for 10 generations.</span></span></span>
<span class="r-in"><span><span class="va">oi</span> <span class="op">&lt;-</span> <span class="va"><a href="https://bbotk.mlr-org.com/reference/OptimInstanceSingleCrit.html" class="external-link">OptimInstanceSingleCrit</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">objective</span>,</span></span>
<span class="r-in"><span>  search_space <span class="op">=</span> <span class="va">search_space</span>,</span></span>
<span class="r-in"><span>  terminator <span class="op">=</span> <span class="fu"><a href="https://bbotk.mlr-org.com/reference/trm.html" class="external-link">trm</a></span><span class="op">(</span><span class="st">"gens"</span>, generations <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3learners.mlr-org.com" class="external-link">"mlr3learners"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># use the 'regr.ranger' as surrogate.</span></span></span>
<span class="r-in"><span><span class="co"># The following settings have 30 individuals in a batch, the 20 best</span></span></span>
<span class="r-in"><span><span class="co"># of which survive, while 10 are sampled new.</span></span></span>
<span class="r-in"><span><span class="co"># For this, 100 individuals are sampled randomly, and the top 10, according</span></span></span>
<span class="r-in"><span><span class="co"># to the surrogate model, are used.</span></span></span>
<span class="r-in"><span><span class="va">smashy_opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bbotk.mlr-org.com/reference/opt.html" class="external-link">opt</a></span><span class="op">(</span><span class="st">"smashy"</span>, <span class="fu"><a href="mut.html">ftr</a></span><span class="op">(</span><span class="st">"surprog"</span>,</span></span>
<span class="r-in"><span>    surrogate_learner <span class="op">=</span> <span class="fu">mlr3</span><span class="fu">::</span><span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"regr.ranger"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    filter.pool_factor <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, fidelity_steps <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  mu <span class="op">=</span> <span class="fl">30</span>, survival_fraction <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># smashy_opt$optimize performs Smashy optimization and returns the optimum</span></span></span>
<span class="r-in"><span><span class="va">smashy_opt</span><span class="op">$</span><span class="fu">optimize</span><span class="op">(</span><span class="va">oi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           x        y        b  x_domain     Obj</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: 2.301525 1.669191 2.310816 &lt;list[3]&gt; 2.32829</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span><span class="co"># Optimizing a Machine Learning Method</span></span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that this is a short example, aiming at clarity and short runtime.</span></span></span>
<span class="r-in"><span><span class="co"># The settings are not optimal for hyperparameter tuning.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3.mlr-org.com" class="external-link">"mlr3"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3learners.mlr-org.com" class="external-link">"mlr3learners"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3tuning.mlr-org.com" class="external-link">"mlr3tuning"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The Learner to optimize</span></span></span>
<span class="r-in"><span><span class="va">learner</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"classif.xgboost"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The hyperparameters to optimize</span></span></span>
<span class="r-in"><span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eta"</span>, <span class="st">"booster"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/to_tune.html" class="external-link">to_tune</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">nrounds</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/to_tune.html" class="external-link">to_tune</a></span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html" class="external-link">p_int</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, tags <span class="op">=</span> <span class="st">"budget"</span>, logscale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get a TuningInstance</span></span></span>
<span class="r-in"><span><span class="va">ti</span> <span class="op">=</span> <span class="va"><a href="https://mlr3tuning.mlr-org.com/reference/TuningInstanceSingleCrit.html" class="external-link">TuningInstanceSingleCrit</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  task <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">tsk</a></span><span class="op">(</span><span class="st">"iris"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  learner <span class="op">=</span> <span class="va">learner</span>,</span></span>
<span class="r-in"><span>  resampling <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">rsmp</a></span><span class="op">(</span><span class="st">"holdout"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  measure <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">msr</a></span><span class="op">(</span><span class="st">"classif.acc"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  terminator <span class="op">=</span> <span class="fu"><a href="https://bbotk.mlr-org.com/reference/trm.html" class="external-link">trm</a></span><span class="op">(</span><span class="st">"gens"</span>, generations <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use ftr("maybe") for random interleaving: only 50% of proposed points are filtered.</span></span></span>
<span class="r-in"><span><span class="va">smashy_tune</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mlr3tuning.mlr-org.com/reference/tnr.html" class="external-link">tnr</a></span><span class="op">(</span><span class="st">"smashy"</span>, <span class="fu"><a href="mut.html">ftr</a></span><span class="op">(</span><span class="st">"maybe"</span>, p <span class="op">=</span> <span class="fl">0.5</span>, filtor <span class="op">=</span> <span class="fu"><a href="mut.html">ftr</a></span><span class="op">(</span><span class="st">"surprog"</span>,</span></span>
<span class="r-in"><span>    surrogate_learner <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"regr.ranger"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    filter.pool_factor <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span>, fidelity_steps <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  mu <span class="op">=</span> <span class="fl">20</span>, survival_fraction <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># smashy_tune$optimize performs Smashy optimization and returns the optimum</span></span></span>
<span class="r-in"><span><span class="va">smashy_tune</span><span class="op">$</span><span class="fu">optimize</span><span class="op">(</span><span class="va">ti</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      nrounds       eta booster learner_param_vals  x_domain classif.acc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: 0.1788264 0.6554934  gbtree          &lt;list[5]&gt; &lt;list[3]&gt;        0.98</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Martin Binder.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

